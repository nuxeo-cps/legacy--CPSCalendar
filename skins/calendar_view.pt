<tal:block define="
  disp_infos python:here.calendar_getDispInformations(request);
  current_action disp_infos/current_action;
  calendar_disp disp_infos/disp;
  selected_day disp_infos/selected_day;
  viewed_day disp_infos/viewed_day;
  start_time disp_infos/start_time;
  end_time disp_infos/end_time;
  events_desc python:here.getEventsDesc(start_time, end_time, calendar_disp)
  ">
<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master">
<metal:block fill-slot="style_plus">
  <link rel="stylesheet" type="text/css"
    tal:attributes="href string:${portal_url}/calendar_stylesheet.css" />
</metal:block>
<body>


<metal:block fill-slot="header_plus"></metal:block>

<metal:block fill-slot="main"
  tal:define="can_add_evts python:mtool.checkPermission('Add portal content', here)">
  <tal:block condition="can_add_evts">
    <tal:block define="ev_dict here/getDeclinedCancelledEvents">
      <form action="calendar_delevents" method="POST"
        tal:define="cancelled ev_dict/cancelled"
        tal:condition="cancelled">
        <input type="hidden" name="ids:list"
          tal:repeat="id cancelled"
          tal:attributes="value id" />
        <input type="submit"
          tal:attributes="value python:mcat('_button_Remove cancelled events_')" />
      </form>
      <form action="calendar_delevents" method="POST"
        tal:define="declined ev_dict/declined"
        tal:condition="declined">
        <input type="hidden" name="ids:list"
          tal:repeat="id declined"
          tal:attributes="value id" />
        <input type="submit"
          tal:attributes="value python:mcat('_button_Remove events you declined_')" />
      </form>
    </tal:block>
    <tal:block define="pendings_count here/getPendingEventsCount"
      condition="pendings_count">
      <h3>
        <a href="calendar_pending_events"
          tal:condition="python:pendings_count > 1"
          tal:content="
            python:mcat('_You have %s pending requests_') % (pendings_count, )">
          You have 2 pending requests.
        </a>
        <a href="calendar_pending_events"
          tal:condition="python:pendings_count == 1"
          tal:content="
            python:mcat('_You have one pending request_')">
          You have one pending request.
        </a>
      </h3>
    </tal:block>
  </tal:block>
  <metal:block use-macro="here/calendar_view_macros/macros/?calendar_disp" />
</metal:block>


</body>
</html>
</tal:block>
